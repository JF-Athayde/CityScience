{% extends "model.html" %}

{% block title %}GreenBuild Report - Eco Explorer{% endblock %}

{% block style %}
<link rel="stylesheet" href="{{ url_for('static', filename='styles/create_bulletin.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='styles/build.css') }}">
{% endblock %}

{% block content %}
{% include 'sub_header.html' %}

<nav class="bulletin-menu">
  <a href="{{ url_for('create_bulletin_urban') }}">Urban Insight</a>
  <a href="{{ url_for('create_bulletin_build') }}" id="b1">GreenBuild Report</a>
</nav>

<div class="bulletin-form-container">
  <!-- Título atualizado para refletir o foco do GreenBuild Report -->
  <h2>Relatório Técnico LEED & Sustentabilidade</h2>
  <form method="POST" action="{{ url_for('create_bulletin_build') }}" class="bulletin-form" onsubmit="showLoading()">
    {{ form.hidden_tag() }}
    
    <!-- Campo 1: Localização -->
    <label for="city">{{ form.city.label.text }}</label>
    {{ form.city(class="") }}

    <!-- Campo 2: Tipo de Projeto (SelectField) -->
    <label for="project_type">{{ form.project_type.label.text }}</label>
    <!-- Adicionando classe 'custom-select' para estilização futura -->
    {{ form.project_type(class="custom-select") }}

    <!-- Campo 3: Nível de Certificação Desejado (SelectField) -->
    <label for="leed_goal">{{ form.leed_goal.label.text }}</label>
    {{ form.leed_goal(class="custom-select") }}
    
    <!-- Campo 4: Foco de Otimização (SelectField) -->
    <label for="focus_area">{{ form.focus_area.label.text }}</label>
    {{ form.focus_area(class="custom-select") }}

    <!-- Campo 5: Detalhes Específicos (Substitui prompt e obs) -->
    <label for="project_details">{{ form.project_details.label.text }}</label>
    <!-- Usando a ID e linhas (rows) para o TextArea -->
    {{ form.project_details(class="", id="project_details", rows="8") }}
    <small>{{ form.project_details.description }}</small>

    {{ form.submit(class="btn-submit") }}
  </form>

  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      <ul class="flashes">
        {% for category, message in messages %}
          <li class="flash {{ category }}">{{ message }}</li>
        {% endfor %}
      </ul>
    {% endif %}
  {% endwith %}
</div>

<div id="loading-overlay">
  <p><strong>Gerando boletim técnico...</strong> Por favor, aguarde alguns instantes.</p>
  <p><em>Nota: Isso pode levar até 2 minutos, dependendo da complexidade.</em></p>
  <div class="spinner"></div>
</div>
{% endblock %}

{% block scripts %}
<script>
  function showLoading() {
    document.getElementById('loading-overlay').style.display = 'flex';
  }
</script>
{% endblock %}